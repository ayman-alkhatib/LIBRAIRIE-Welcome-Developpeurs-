<!DOCTYPE html>
<html lang="fr">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Magasin</title>
  <!--
  <link rel="stylesheet" href="./css/styles.css">
  -->
  <link rel="stylesheet" href="./css/all.css">
  <link rel="stylesheet" href="./css/magasin.css">
  <link rel="stylesheet" href="./css/main.css"> 
  <link rel="stylesheet" href="./css/panierStyle.css">
</head>

<body class="magasin">
    <header> 
        <div class="container">

            <nav>
                <img src="./images/books-images/logo.png" alt="">
                <h4>LIBRAIRIE "Welcome Développeurs"</h4>
                <ul>
                    <li><a href="./index.html">Le Magasin <i class="fas fa-store"></i></a></li>
                    <li><a href="./panier.html">Le Panier <i class="fas fa-cart-shopping"></i></a></li>
                    <li><a href="./equipe.html">L'équipe <i class="fas fa-people-group"></i></a></li>
                </ul>
            </nav>
        </div>
    </header>
    <!-- Start landing-->
    <section class="landing"></section>

  <article>

    <section>
      <h1>Bienvenue à la Librairie "Welcome Développeurs"</h1>
      <div>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed non risus. Suspendisse lectus tortor, dignissim
        sit amet, adipiscing nec, ultricies sed, dolor. Cras elementum ultrices diam. Maecenas ligula massa, varius a,
        semper congue, euismod non, mi. Proin porttitor, orci nec nonummy molestie, enim est eleifend mi, non fermentum
        diam nisl sit amet erat. </div>


      <h2>Sélection de livres</h2>
      <ul class="books"></ul>

    </section>


  </article>

      <script src="./js/data.js"></script>

      <script>
        books.forEach((bookObj) => {
		
          let myMainElement = document.querySelector(".books")
          let book = document.createElement("li")
          let img = document.createElement("img")
          let title = document.createElement("h3");
          let author = document.createElement("div")
          let price = document.createElement("h3");
          let cart_button = document.createElement("button");
          let quantity_container = document.createElement("div");
          let quantity = document.createElement("input");

          // Add the link of the img
          img.src = `./images/books-images/${bookObj.url}`

          // Add book title
          title.append(bookObj.title);

          //add author name
          author.append(bookObj.author)

          // Add price Text
		  
           price.append(`$${bookObj.price}`)
		  price.classList.add('prix_magasin');	


          quantity.type = "number";
          quantity.label = "quantité";
          quantity.value = 0;
		  quantity.min = 0;
          quantity.id = `C-${bookObj.id}`;
		  quantity.classList.add('magasin');		

          cart_button.id = bookObj.id;
          cart_button.classList.add('magasin');		  
          cart_button.innerHTML = 'Ajouter au panier';
		  cart_button.onclick = add2cart
		  //cart_button.onclick = init_qty(bookObj.id)		  
		  localStorage.setItem(`qty_book_${bookObj.id}`,0) //met les qté à zéro dans le local storage
		  
          

          // Add img to book
          book.append(img)

          // Add title To book
          book.appendChild(title);

          // Add author to book
          book.appendChild(author)

          // Add price To book
          book.appendChild(price);

          // Add quantity field To quantity container
          quantity_container.appendChild(quantity);

          // Add quantity field To book
          book.appendChild(quantity_container);

          // Add cart button To book
          book.appendChild(cart_button);


          // Add id to book bookObj
          book.id = bookObj.id;

          myMainElement.appendChild(book)

        })
		//let booksAjouter = []

		//function init_cart(){
		
		
		
		//}

		
		function add2cart(){
			let count = document.querySelector(`#C-${this.id}`)
	
			if (parseInt(count.value) ==1) {
				alert(`${count.value} ajouté au panier`);
			} else {
				alert(`${count.value} ajoutés au panier`);
			}

			
			let old_count=localStorage.getItem(`qty_book_${this.id}`);

			console.log(old_count)
			
			localStorage.setItem(`qty_book_${this.id}`,parseInt(old_count)+parseInt(count.value))

			
			
			//remise à zéro quantité dans le input
			document.querySelector(`#C-${this.id}`).value = 0
			
			
		}

		
		
		
		
		
		
      </script>




</body>

</html>